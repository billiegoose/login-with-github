{"version":3,"file":null,"sources":["../src/LoginWithGithub.js"],"sourcesContent":["\"use strict\"\n\nfunction initState () {\n  return window.crypto.getRandomValues(new Uint8Array(8)).toString()\n}\n\nfunction generateLoginLink ({client_id, state}) {\n  return 'https://github.com/login/oauth/authorize?client_id=' + client_id + '&state=' + state\n}\n\nexport default function waitForPopup ({client_id}) {\n  let state = initState()\n  let url = generateLoginLink({client_id, state})\n  let mychild = window.open(url)\n  new Promise(function(resolve, reject) {\n    window.addEventListener('message', function (event) {\n      // Validate sender\n      if (event.source !== mychild) {\n        return console.warn('recieved an unexpected postMessage')\n      }\n      // Validate state\n      if (event.data && event.data.state) {\n        if (event.data.state !== state) {\n          return reject('state variable mismatch')\n        }\n        resolve({\n          client_id: client_id,\n          code: event.data.code,\n          state: state\n        })\n      } else {\n        reject(event)\n      }\n    })\n  })\n}\n"],"names":["initState","window","crypto","getRandomValues","Uint8Array","toString","generateLoginLink","client_id","state","waitForPopup","url","mychild","open","Promise","resolve","reject","addEventListener","event","source","console","warn","data","code"],"mappings":";;;;;;AAEA,SAASA,SAAT,GAAsB;SACbC,OAAOC,MAAP,CAAcC,eAAd,CAA8B,IAAIC,UAAJ,CAAe,CAAf,CAA9B,EAAiDC,QAAjD,EAAP;;;AAGF,SAASC,iBAAT,OAAgD;MAAnBC,SAAmB,QAAnBA,SAAmB;MAARC,KAAQ,QAARA,KAAQ;;SACvC,wDAAwDD,SAAxD,GAAoE,SAApE,GAAgFC,KAAvF;;;AAGF,AAAe,SAASC,YAAT,QAAoC;MAAZF,SAAY,SAAZA,SAAY;;MAC7CC,QAAQR,WAAZ;MACIU,MAAMJ,kBAAkB,EAACC,oBAAD,EAAYC,YAAZ,EAAlB,CAAV;MACIG,UAAUV,OAAOW,IAAP,CAAYF,GAAZ,CAAd;MACIG,OAAJ,CAAY,UAASC,OAAT,EAAkBC,MAAlB,EAA0B;WAC7BC,gBAAP,CAAwB,SAAxB,EAAmC,UAAUC,KAAV,EAAiB;;UAE9CA,MAAMC,MAAN,KAAiBP,OAArB,EAA8B;eACrBQ,QAAQC,IAAR,CAAa,oCAAb,CAAP;;;UAGEH,MAAMI,IAAN,IAAcJ,MAAMI,IAAN,CAAWb,KAA7B,EAAoC;YAC9BS,MAAMI,IAAN,CAAWb,KAAX,KAAqBA,KAAzB,EAAgC;iBACvBO,OAAO,yBAAP,CAAP;;gBAEM;qBACKR,SADL;gBAEAU,MAAMI,IAAN,CAAWC,IAFX;iBAGCd;SAHT;OAJF,MASO;eACES,KAAP;;KAhBJ;GADF;;;;;"}